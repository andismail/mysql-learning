高可用
	概念:
		指通过尽量缩短因日常维护操作和突发的系统崩溃所导致的停机时间,以提高系统和应用的可用性
	起因:
		1.严重的主从延迟
		2.主从复制中断
		3.锁引起的大量阻塞
		4.软硬件故障造成的服务器宕机
	导致不可用的因素:
		1.服务器磁盘空间耗尽
			备份或各种查询日志突增导致磁盘空间被占满.MySQL由于无法记录二进制日志,无法处理新的请求而产生的系统不可能故障
		2.性能糟糕的SQL
		3.表结构和索引没有优化
		4.主从数据不一致
		5.人为操作失误等
	解决:
		建立完善的监控及报警系统(注意:避免错报和漏报)
		对备份数据进行恢复测试
		正确配置数据库环境(从库一定要配置成只读)
		对不需要的数据进行归档和清理
		增加系统冗余,保证发生系统不可用时可以尽快恢复(1避免存在单点故障 2主从切换及故障转移)
	使用MySQL解决主从复制需要解决的问题:
		1.主服务器切换后,如何通知应用新的主服务器的IP地址?
		2.如何检查主服务器是否可用?
		3.如何处理从服务器和新主服务器之间的那种复制关系?
	
工具
	1.MMM,较早,不支持新的MySQL复制功能
	2.MHA(Master High Avaliable)
		1.介绍:
			由Perl开发,为管理MySQL主从复制从而实现其高可用的一套比较成熟的工具套装,从其名称中可知它关注的是主DB,其功能是在MySQL主从架构
			下完成故障切换从众多的从服务器中自动实现,MHA可以高效地实现主从切换,基本可以在30秒内完成主从切换,可以最大程度上保证数据一致性,
			达到真正意义上的高可用
		2.功能:
			1.监控主数据库服务是否可用
			2.当主数据库不可用时可以从多个从服务器中选举出新的主数据库
			3.提供主从切换和故障转移功能
		3.免登陆
			1.ssh-kengen 生成ssh key,把key拷贝到想要免密码登陆的机器上 ssh-copy-id -i /Users/Jthan/.ssh/id_rsa 'root@192.168.1.204'

	3.优缺点:
		优点:
		由Perl语言开发的开源工具
		可以支持GTID的复制模式
		MHA在故障转移时更不易产生数据丢失
		同一个监控结点可以控制多个集群
		
		缺点:
		需要编写脚本或三方工具来实现Vip配置
		MHA启动后只会对主数据库进行监控
		需要基于SSH免认证配置,存在一定安全隐患
		没有提供从服务器的读负载均衡功能

读写分离、负载均衡: 读写分离和负载均衡是两个不同的概念,同时并不是所有的查询都适合去做读写分离
	读写分离:
		把数据库的读操作和写操作落在不同的库上,进行MySQL主从复制配置的一个主要目的就是为了分担主库的读负载,因为对于大多数应用来说数据库所
		承担的读负载要远远高于写的负载
	为什么要读写分离:
		写负载是不能够分担的,而且只能在主上进行写操作,而读操作在主从上都可以进行, 所以为了减少主库由于读操作带来的压力把读写操作分开,写操作
		在主库上完成,读操作尽量的在从库上进行
	实现读写分离:
		1.由程序实现:适用于大多数自主开发的系统中
			优点:
				1.可以由开发人员控制什么样查询在从库中执行,因此比较灵活(说明:主从同步是有延迟的虽然可能为毫秒级别,但有些查询是不准许
			          这样的延迟,所以这样的查询需到主库上查询)
				2.由于程序直接连接的是数据库其性能损耗的较少,和使用中间件比也会减少故障点架构更为简单方便维护
			缺点:
				1.最为明显的就是增加了开发工作量,代码可能变得复杂从
				2.人为控制,容易出现错误,可能造成本应在从库上的读操作落在了主库上
				3.后期维护不易,若上线后再去更改连接成本太高
		2.由中间件实现:
			mysql-proxy:虽然功能不错,但问题不少,性能也存在问题,而且一直没正式版本,所以不建议使用
			maxScale:实现读写分离,实现负载均衡
			优点:
				1.会根据SQL语法分析自动完成读写分离,对于存储过程这种无法分析的只能在主库上执行
				2.对程序透明,对已有程序不用做任何调整
			缺点:
				1.由于增加了中间层,程序会连接到中间层服务器然后中间层服务器再去找从库再去查询,所以查询效率有损耗
				2.对于延迟敏感业务无法自动在主库上执行,也就是没有那么灵活
	负载均衡:读的负载均衡主要解决的是相同角色的数据库如何相同多的负载
		实现:
			1.由程序轮询,由程序控制具体的在哪个数据库上查询
				如果使用这种方式则每次增加或减少服务器就要修改程序
			2.由软件LVS,Haproxy,Maxscale或硬件如F5实现
		使用Maxscale:
			1.安装
			2.配置:简单但需要配置的不少
			注:并未实际操作
